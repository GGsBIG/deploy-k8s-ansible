# Kubernetes é›†ç¾¤å¥—ä»¶ç‰ˆæœ¬æ¸…å–®

## ğŸ“‹ æ¦‚è¿°
æœ¬æ–‡æª”è¨˜éŒ„äº† Kubernetes é›†ç¾¤ä¸­éƒ¨ç½²çš„æ‰€æœ‰å¥—ä»¶åŠå…¶ç‰ˆæœ¬ä¿¡æ¯ï¼ŒåŒ…å«æ ¸å¿ƒçµ„ä»¶ã€ç›£æ§ç³»çµ±ã€æ—¥èªŒç®¡ç†ã€è¿½è¹¤å·¥å…·å’Œç®¡ç†ç•Œé¢ã€‚

---

## ğŸš€ æ ¸å¿ƒ Kubernetes çµ„ä»¶

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | é¡å‹ | æè¿° |
|---------|------|------|------|
| **Kubernetes** | v1.32.4 | å®¹å™¨ç·¨æ’ | åŒ…å« kubelet, kubeadm, kubectl |
| **containerd** | v2.1.3 | å®¹å™¨é‹è¡Œæ™‚ | å®¹å™¨é‹è¡Œæ™‚å¼•æ“ |
| **runc** | v1.3.0 | å®¹å™¨é‹è¡Œæ™‚ | ä½éšå®¹å™¨é‹è¡Œæ™‚ |
| **CNI plugins** | v1.7.1 | ç¶²çµ¡æ’ä»¶ | å®¹å™¨ç¶²çµ¡æ¥å£æ’ä»¶ |
| **Calico CNI** | v3.29.4 / v3.30.2 | ç¶²çµ¡è§£æ±ºæ–¹æ¡ˆ | ç¶²çµ¡ç­–ç•¥å’Œè·¯ç”± |
| **kube-vip** | æœ€æ–°ç‰ˆæœ¬ | é«˜å¯ç”¨æ€§ | è™›æ“¬ IP ç®¡ç† |

---

## ğŸŒ Ingress æ§åˆ¶å™¨

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Nginx Ingress Controller** | v4.11.3 | 172.21.169.73 | 80/443 | HTTP/HTTPS è·¯ç”± |
| **Istio Control Plane** | æœ€æ–°ç‰ˆæœ¬ | - | - | æœå‹™ç¶²æ ¼æ§åˆ¶å¹³é¢ |
| **Istio Ingress Gateway** | æœ€æ–°ç‰ˆæœ¬ | 172.21.169.72 | 80/443 | æœå‹™ç¶²æ ¼å…¥å£ |

---

## ğŸ“Š ç›£æ§ç³»çµ±

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Prometheus Stack** | v61.1.1 | 172.21.169.75 | 9090 | ç›£æ§æ•¸æ“šæ”¶é›† |
| **Grafana** | v8.5.1 | 172.21.169.74 | 3000 | ç›£æ§è¦–è¦ºåŒ–å„€è¡¨æ¿ |
| **AlertManager** | åŒ…å«åœ¨ Prometheus Stack | - | 9093 | å‘Šè­¦ç®¡ç† |
| **Node Exporter** | åŒ…å«åœ¨ Prometheus Stack | - | 9100 | ç¯€é»æŒ‡æ¨™æ”¶é›† |
| **Kube State Metrics** | åŒ…å«åœ¨ Prometheus Stack | - | 8080 | Kubernetes è³‡æºæŒ‡æ¨™ |

---

## ğŸ” åˆ†æ•£å¼è¿½è¹¤

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Jaeger Operator** | v1.57.0 | - | - | Jaeger ç®¡ç†å“¡ |
| **Jaeger All-in-One** | v1.57 | 172.21.169.82 | 16686 | åˆ†æ•£å¼è¿½è¹¤ UI |
| **Jaeger Collector** | v1.57 | - | 14268/14250 | è¿½è¹¤æ•¸æ“šæ”¶é›†å™¨ |
| **Zipkin Endpoint** | v1.57 | - | 9411 | Zipkin å…¼å®¹ç«¯é» |

---

## ğŸ•¸ï¸ æœå‹™ç¶²æ ¼å¯è§€æ¸¬æ€§

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Kiali** | v1.86.0 | 172.21.169.77 | 20001 | æœå‹™ç¶²æ ¼è¦–è¦ºåŒ– |
| **Kiali Operator** | v1.86.0 | - | - | Kiali ç®¡ç†å“¡ |

---

## ğŸ“ æ—¥èªŒç®¡ç† (ELK Stack)

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Elasticsearch** | v8.5.1 | - | 9200 | æœç´¢å’Œåˆ†æå¼•æ“ |
| **Kibana** | v8.5.1 | 172.21.169.71 | 5601 | æ—¥èªŒæœç´¢å’Œè¦–è¦ºåŒ– |
| **Filebeat** | v8.5.1 | - | - | æ—¥èªŒæ”¶é›†å™¨ |

---

## ğŸ› ï¸ ç®¡ç†å·¥å…·

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æœå‹™ IP | ç«¯å£ | æè¿° |
|---------|------|---------|------|------|
| **Kubernetes Dashboard** | v2.7.0 | 172.21.169.81 | 8443 | é›†ç¾¤ç®¡ç†ç•Œé¢ |
| **Swagger UI** | v5.9.0 | 172.21.169.79 | 8080 | API æ–‡æª”å’Œæ¸¬è©¦ |

---

## ğŸ”§ åŸºç¤è¨­æ–½çµ„ä»¶

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æè¿° |
|---------|------|------|
| **MetalLB** | v0.13.12 | è² è¼‰å‡è¡¡å™¨ |
| **NFS Provisioner** | - | å‹•æ…‹æŒä¹…åŒ–å­˜å„² |
| **chrony** | æœ€æ–° | æ™‚é–“åŒæ­¥æœå‹™ |

---

## ğŸ“¦ ç³»çµ±å¥—ä»¶

| å¥—ä»¶åç¨± | ç‰ˆæœ¬ | æè¿° |
|---------|------|------|
| **jq** | æœ€æ–° | JSON è™•ç†å·¥å…· |
| **curl** | æœ€æ–° | HTTP å®¢æˆ¶ç«¯ |
| **apt-transport-https** | æœ€æ–° | APT HTTPS æ”¯æ´ |
| **ca-certificates** | æœ€æ–° | CA è­‰æ›¸ |
| **gpg** | æœ€æ–° | GPG åŠ å¯†å·¥å…· |

---

## ğŸŒ ç¶²çµ¡é…ç½®

| é…ç½®é …ç›® | å€¼ | æè¿° |
|---------|---|------|
| **Pod CIDR** | 10.244.0.0/16 | Pod ç¶²æ®µ |
| **Service CIDR** | 10.96.0.0/16 | æœå‹™ç¶²æ®µ |
| **Control Plane Endpoint** | 10.10.7.216:6443 | æ§åˆ¶å¹³é¢ç«¯é» |
| **kube-vip VIP** | 10.10.7.216 | è™›æ“¬ IP åœ°å€ |

---

## ğŸ“ æœå‹™ IP åˆ†é…è¡¨

| æœå‹™åç¨± | IP åœ°å€ | ç«¯å£ | å”è­° | ç”¨é€” |
|---------|---------|------|------|------|
| **Nginx Ingress** | 172.21.169.73 | 80/443 | HTTP/HTTPS | å…¥å£æ§åˆ¶å™¨ |
| **Istio Ingress** | 172.21.169.72 | 80/443 | HTTP/HTTPS | æœå‹™ç¶²æ ¼å…¥å£ |
| **Prometheus** | 172.21.169.75 | 9090 | HTTP | ç›£æ§æ•¸æ“šæ”¶é›† |
| **Grafana** | 172.21.169.74 | 3000 | HTTP | ç›£æ§è¦–è¦ºåŒ– |
| **Jaeger UI** | 172.21.169.82 | 16686 | HTTP | åˆ†æ•£å¼è¿½è¹¤ |
| **Kiali** | 172.21.169.77 | 20001 | HTTP | æœå‹™ç¶²æ ¼è¦–è¦ºåŒ– |
| **Kibana** | 172.21.169.71 | 5601 | HTTP | æ—¥èªŒæœç´¢ |
| **K8s Dashboard** | 172.21.169.81 | 8443 | HTTPS | é›†ç¾¤ç®¡ç† |
| **Swagger UI** | 172.21.169.79 | 8080 | HTTP | API æ–‡æª” |

---

## ğŸ”„ ç‰ˆæœ¬ç®¡ç†èªªæ˜

### å›ºå®šç‰ˆæœ¬
- æ‰€æœ‰ Helm Chart ä½¿ç”¨å›ºå®šç‰ˆæœ¬è™Ÿç¢ºä¿éƒ¨ç½²ä¸€è‡´æ€§
- Kubernetes çµ„ä»¶ç‰ˆæœ¬å·²é–å®š (apt-mark hold)

### å‹•æ…‹ç‰ˆæœ¬
- **kube-vip**: è‡ªå‹•ç²å– GitHub æœ€æ–° release
- **Istio**: ä½¿ç”¨ istioctl ä¸‹è¼‰æœ€æ–°ç©©å®šç‰ˆ

### å­˜å„²é…ç½®
- **StorageClass**: nfs-storage
- **å­˜å„²å¾Œç«¯**: NFS Server
- **æŒä¹…åŒ–å·**: ReadWriteOnce

---

## ğŸ“ éƒ¨ç½²é †åº

1. **ç³»çµ±æº–å‚™** â†’ æ™‚é–“åŒæ­¥ã€å…§æ ¸æ¨¡çµ„ã€ç¶²çµ¡é…ç½®
2. **å®¹å™¨é‹è¡Œæ™‚** â†’ containerd + runc + CNI
3. **Kubernetes æ ¸å¿ƒ** â†’ kubelet, kubeadm, kubectl
4. **kube-vip** â†’ é«˜å¯ç”¨æ€§è™›æ“¬ IP
5. **é›†ç¾¤åˆå§‹åŒ–** â†’ kubeadm init + Calico CNI
6. **Ingress** â†’ Nginx Ingress + Istio
7. **ç›£æ§** â†’ Prometheus + Grafana
8. **è¿½è¹¤** â†’ Jaeger + Kiali
9. **æ—¥èªŒ** â†’ Elasticsearch + Kibana + Filebeat
10. **ç®¡ç†å·¥å…·** â†’ Dashboard + Swagger UI

---

## ğŸ·ï¸ æ¨™ç±¤å’Œè¨»è§£

### Helm Repository
- `ingress-nginx`: https://kubernetes.github.io/ingress-nginx
- `prometheus-community`: https://prometheus-community.github.io/helm-charts
- `grafana`: https://grafana.github.io/helm-charts
- `kiali`: https://kiali.org/helm-charts
- `elastic`: https://helm.elastic.co

### é‡è¦è¨»è§£
- `metallb.universe.tf/loadBalancerIPs`: MetalLB IP åˆ†é…
- `prometheus.io/scrape`: Prometheus è‡ªå‹•ç™¼ç¾
- `istio-injection=enabled`: Istio Sidecar æ³¨å…¥

---

## ğŸ“š ç›¸é—œæ–‡æª”

- [Kubernetes å®˜æ–¹æ–‡æª”](https://kubernetes.io/docs/)
- [Istio æ–‡æª”](https://istio.io/latest/docs/)
- [Prometheus æ–‡æª”](https://prometheus.io/docs/)
- [Grafana æ–‡æª”](https://grafana.com/docs/)
- [Jaeger æ–‡æª”](https://www.jaegertracing.io/docs/)
- [Elastic Stack æ–‡æª”](https://www.elastic.co/guide/)

---

**æœ€å¾Œæ›´æ–°**: 2025-08-21  
**é›†ç¾¤åç¨±**: ETTTT  
**ç’°å¢ƒ**: ç”Ÿç”¢ç’°å¢ƒ  
**ç¯€é»æ•¸é‡**: 6 å€‹ (3 Master + 3 Worker)